<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>2.1 Обращение к объектом БД 1IM из маппинга - 1IM Wiki</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">1IM Wiki</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>2.1 Обращение к объектом БД 1IM из маппинга</p>
<p>15 ноября 2022 г.</p>
<p>12:17</p>
<blockquote>
<p>Hi Michele,</p>
<p>as you have assumed, you need to define a <em>Script property</em> to achieve
your goal.</p>
<p>In the script you have access to the properties of the current object,
the current value when the sync engine tries to set a property and you
can query for other objects the connector has access to, defined by
your current schema definition (we come to that in a second).</p>
<p>The sync engine itself, and therefore the scripted property has no
direct access to the OneIM database, the object layer or the script
library.</p>
<p>Having explained that, here is your solution:</p>
</blockquote>
<ul>
<li>
<p>You need to define script property on the OneIM (the left) side of the
  mapping in the Department objects. In my sample, it is
  called *vrtPersonHead. *</p>
</li>
<li>
<p>As in your use-case definition, we only need a write script.</p>
</li>
</ul>
<blockquote>
<p><img
src="../media/2.1 Обращение к объектом БД 1IM из маппинга/media/image1.png"
style="width:2.82292in;height:2.5in" /></p>
</blockquote>
<ul>
<li>Script code is the following:</li>
</ul>
<blockquote>
<p>Imports VI.Projector.Connection</p>
<p>Dim Person AsISystemObject=
SystemObject.Connection.QueryObject(SystemQuery _</p>
<p>.From("Person") _</p>
<p>.Select("UID_PersonHead", "UID_PersonMasterIdentity") _</p>
<p>.Filter(String.Format("CustomProperty01='{0}'", value.ToString))</p>
<p>).Result.FirstOrDefault</p>
<p>IfNot Person Is NothingThen</p>
<p>IfString.IsNullOrEmpty(Person.GetValue("UID_PersonMasterIdentity").AsString)
Then</p>
<p>\$UID_PersonHead\$ := Person.GetValue("UID_PersonHead").AsString</p>
<p>Else</p>
<p>\$UID_PersonHead\$ :=
Person.GetValue("UID_PersonMasterIdentity").AsString</p>
<p>End If</p>
<p>End If</p>
</blockquote>
<ul>
<li>You need a mapping from your CSV column that stores the <em>Manager
  lookup value</em> to the new script property. In my sample, this is the
  mapping column <em>CustomProperty01</em> in my CSV file to the script
  property <em>vrtPersonHead</em>.</li>
</ul>
<blockquote>
<p><img
src="../media/2.1 Обращение к объектом БД 1IM из маппинга/media/image2.png"
style="width:5in;height:2.32292in" /></p>
</blockquote>
<ul>
<li>You need to pin the <em>Person</em> objects in your schema, as the connector
  is only able to access objects that are part of your sync project
  schema. So when you shrink the schema, you need to exclude
  the <em>Person</em> table from the shrink, when it isn't a part of your sync
  project already.</li>
</ul>
<blockquote>
<p>The script demonstrates the use of:</p>
</blockquote>
<ul>
<li>
<p>How to query data from other objects that are part of your sync
  project.</p>
</li>
<li>
<p>How to set another property in your object (:= notation) in a write
  script</p>
</li>
<li>
<p>How to us the current <em>value </em>in a write script.</p>
</li>
</ul>
<blockquote>
<p>Hope that helps.</p>
<p><em>From
\&lt;<a href="https://www.oneidentity.com/community/identity-manager/f/forum/21645/synchronization-editor-problem-mapping-property-with-script-retrieve-object">https://www.oneidentity.com/community/identity-manager/f/forum/21645/synchronization-editor-problem-mapping-property-with-script-retrieve-object</a>&gt;</em></p>
</blockquote></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
