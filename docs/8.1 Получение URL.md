8.1 Получение URL

5 сентября 2025 г.

10:19

 

Получить URL на которой странице находится пользователь и если она
содержит имя компонента CCC_ITShop_OrderHistory_New, то записать это
значение в поле SingleRowCollection

 

var request = System.Web.HttpContext.Current.Request;

string result = "";

string referer = request.UrlReferrer != null

? request.UrlReferrer.AbsoluteUri

: string.Empty;

if (referer.Contains("ContextID=CCC_ITShop_OrderHistory_New")) {result =
"CCC_ITShop_OrderHistory_New";}

 

VI.WebRuntime.IDataColumn \_SourceComponent1 =
this.Vars1.GetColumn("SourceComponent");

System.Collections.Generic.IEnumerator\<VI.WebRuntime.RowCursor\>
\_enumerating7 = new
VI.WebRuntime.RowCursorList(this.Vars1).GetEnumerator();

for (int \_rowIndex7 = 0; \_enumerating7.MoveNext(); \_rowIndex7 =
(\_rowIndex7 + 1))

{

VI.WebRuntime.RowCursor Update14_Current = \_enumerating7.Current;

await \_SourceComponent1.SetValueAsync(Update14_Current.Row,
result).ConfigureAwait(false);

}
