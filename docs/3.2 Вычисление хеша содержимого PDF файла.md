3.2 Вычисление хеша содержимого PDF файла

19 мая 2025 г.

15:13

 

Через Visual Studio загрузить пакет NuGet PdfPig

Скопировать из папки с пакетом файлы из папки
packages\pdfpig\0.1.10\lib\net462 в корень папки с 1IM

 

Пишем скрипт на VB.NET

 

\#If Not SCRIPTDEBUGGER Then

> **References UglyToad.PdfPig.dll**
>
> Imports System.Security.Cryptography
>
> Imports System.Text
>
> **Imports UglyToad.PdfPig**

 

\#End If

 

Public Function CCC_GetFileHash(ByVal pdfPath As String) As String

Dim sb As New StringBuilder()

 

Using pdf = UglyToad.PdfPig.PdfDocument.Open(pdfPath)

For Each page In pdf.GetPages()

sb.AppendLine(page.Text)

Next

End Using

 

Dim textBytes As Byte() = Encoding.UTF8.GetBytes(sb.ToString())

Using sha256 As SHA256 = SHA256.Create()

Dim hashBytes As Byte() = sha256.ComputeHash(textBytes)

Return BitConverter.ToString(hashBytes).Replace("-",
"").ToLowerInvariant()

> 'Return sb.ToString()

End Using

>  

End Function

 
