6.17 Запуск скрипта с портала

12 мая 2023 г.

12:26

 

var runner = new
VI.DB.Scripting.ScriptRunner(\_Connection.Scripts\["scripts"\],
\_Database);

 

runner.Eval("NameOfYourScript", new object\[\]{ someParameter });

 

----

Class Test

 

> Public \_s As VI.DB.Entities.ISession
>
> Dim \_prop As String
>
>  
>
> Public Property Prop() As String
>
> Get
>
> Return Me.\_prop
>
>  
>
> End Get
>
>  
>
> Set(ByVal t As String)
>
> Dim runner = New
> VI.DB.Scripting.ScriptRunner(Me.\_s.Scripts()(VI.DB.Scripting.ScriptContext.Scripts),
> Me.\_s)
>
> Dim result = **runner.Eval("CCC_MyScript", {"John", "@company.com"})**
>
> Me.\_prop = CStr(result)
>
> End Set
>
>  
>
> End Property
>
>  

End Class

---

<img src="../media/6.17 Запуск скрипта с портала/media/image1.png"
style="width:10.78125in;height:3.625in" />

---

var CCC_UID_person =
this.DataContext.ScriptData.GetColumn("UID_Person");

var CCC_DoApprove = this.DataContext.ScriptData.GetColumn("DoApprove");

var CCC_UID_PWO = this.DataContext.ScriptData.GetColumn("UID_PWO");

var CCC_SubLevel = this.DataContext.ScriptData.GetColumn("SubLevel");

var CCC_Reason = this.DataContext.ScriptData.GetColumn("ReasonText");

var CCC_uidJustification =
this.DataContext.ScriptData.GetColumn("uidJustification");

 

var runner = new
VI.DB.Scripting.ScriptRunner(\_Connection.Scripts\["scripts"\],
\_Database);

var row1 = this.DataContext.ScriptData.FirstOrDefault();

 

runner.Eval("CCC_PWOCallMakeDecisionMethod", new object\[\]{
CCC_UID_PWO.GetValue(row1).ToString(),
CCC_UID_person.GetValue(row1).ToString(),
bool.Parse(CCC_DoApprove.GetValue(row1).ToString()),
CCC_Reason.GetValue(row1).ToString(),
CCC_uidJustification.GetValue(row1).ToString(),
Convert.ToInt32(CCC_SubLevel.GetValue(row1).ToString()) });

 

---

