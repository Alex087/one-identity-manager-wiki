6.6 Формирование списка значений в строку на основе коллекции

29 августа 2025 г.

11:17

 

> <img
> src="../media/6.6 Формирование списка значений в строку на основе коллекции/media/image1.png"
> style="width:3.91667in;height:3.60417in" />
>
>  

1.  Создаем колонку для заполнения значениями из коллекции

2.  Заполняем коллекцию значениями, которые потом будем складывать в
    созданную колонку

3.  Проходимся ForEachRow по коллекции с значениями

4.  Создаем Switch

5.  Первое условие - одно значение в исходной коллекции

6.  Делаем Update созданной колонки

> format("'{0}'", from Files select Current UID_CCCFiles)

7.  Второе условие - Update созданной колонки, когда в коллекции не одно
    значение

> format("{0},'{1}'",from CCCFilesAgreed_Temp select UIDs_CCCFiles, from
> Files select Current UID_CCCFiles)

8.  Делает ещё один Switch вне ForEachRow для того, чтобы отсечь лишнюю
    запятую вначале

9.  Условие (нахождение лишней запятой)

> substring(from CCCFilesAgreed_Temp select UIDs_CCCFiles,0,1) = ","

10. Отсечение лишней запятой - Update новой колонки

> substring(format("{0}",from CCCFilesAgreed_Temp select
> UIDs_CCCFiles),1)
>
>  

