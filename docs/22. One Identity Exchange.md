22\. One Identity Exchange

23 марта 2020 г.

16:20

 

# <span class="mark">Ports</span>

\- For Powershell the defaults are 5985 and 5986.

 

\- Standard TCP/IP ports (usually 80 and 443).

 

*From
\<<https://support.oneidentity.com/identity-manager/kb/4348438/ports-required-to-connect-to-exchange-server>\>*

 

#  

#  

# <span class="mark">Troubleshooting</span>

1\) Не создается почтовый ящик при Account Definition

При назначении AccountDefinition не создается почтовый ящик

Надо

Для Exchange Acc Def задать требуемый Acc Def – AD

 

# Alias 

 

If Not CBool(Connection.Variables("Fullsync")) AndAlso Not
String.IsNullOrEmpty(\$UID_EX0Organization\$) Then

Dim myAlias as String = ""

Dim f as ISqlFormatter = Connection.SqlFormatter

If Not Entity.Columns.Item("Alias").ChangeLevels.Get(0) Then

'not manually set Alias

myAlias = \$FK(UID_ADSAccount).Mail\$

If InStr(myAlias, "@")\> 0 Then

myAlias = vid_Left(myAlias, InStr(myAlias, "@")-1)

End If

Else

myAlias = CStr(Value)

End If

' if there is already a element with this name in this organization,
append a number

If \$Alias\[o\]\$ \<\> myAlias AndAlso Not String.IsNullOrEmpty(myAlias)
Then

' make the name unique by appending a counter

Dim i as Integer = 1

Dim myAliasNew = myAlias

Do While Session.Source().Exists(

"EX0VElementName", \_

f.AndRelation( \_

f.UidComparison("XObjectKey", \$XObjectKey\$, CompareOperator.NotEqual),
\_

f.UidComparison("UID_EX0Organization", \$UID_EX0Organization\$), \_

f.Comparison("Alias", myAliasNew,ValType.String) \_

))

If myAlias.Length \> 64 - i.ToString().Length Then

myAliasNew = myAlias.Substring(0, 64-i.ToString().Length) & i.ToString()

Else

myAliasNew = myAlias & i.ToString()

End If

i = i + 1

Loop

Value = myAliasNew

End If

End If

---------------------------------------------------------------
