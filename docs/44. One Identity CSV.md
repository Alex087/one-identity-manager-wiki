44\. One Identity CSV

13 февраля 2026 г.

11:46

 

5\) **Импорт из csv**

1\. create a script with dataimporter

2\. Create new process with a scriptexec and set script name to Value =
"\<scriptname\>"

3\. create new event for this script (in first step on parameters add e
new event ...any name, just remember it :-)

3.Go to process orchestration and create new process plan  
that it is tied to DialogDatabase table and to event that You created
before (both are selected from dropdown)

4.Also create new schedule (+ button on process schedule will do ;-) )
and that it is !

--

If \$STARTDATE\$ \<\> "" Then

Value=Date.ParseExact(\$STARTDATE\$, "dd.**MM**.yyyy",
CultureInfo.InvariantCulture)

End If

 

mm - минуты!!!

MM - месяц!!!

 

**Department**

DEPARTMENTCODE = UID_DepartmentID

DEPARTMENTNAME = DepartmentName

DEPARTMENTFULLNAME = Description

PARENTCODE = UID_DepartmentParentID

ORGUNIT = Commentary

 

**Преобразование поля, через скрипт**

Если надо каждый раз прогонять данные, через скрипт - должна быть
включена галка Override, но скрипт не будет прогоняться, если данные не
меняются.

Надо в начале крипта сделать коммент с именем столбца, который меняется

'\$STARTDATE\$

 

**Из кириллицы в латиницу**

Public Function CCC_transliteration(ByVal inputValue As String) As
String

inputValue = inputValue.ToLower()

Dim SB As New System.Text.StringBuilder

Dim Rus As String() = {"а", "б", "в", "г", "д", "е", "ё", "ж", "з", "и",
"й", "к", \_

"л", "м", "н", "о", "п", "р", "с", "т", "у", "ф", "х", "ц", "ч", "ш", \_

"щ", "ъ", "ы", "ь", "э", "ю", "я"}

Dim Eng As String() = {"a", "b", "v", "g", "d", "e", "e", "zh", "z",
"i", "i", \_

"k", "l", "m", "n", "o", "p", "r", "s", "t", "u", "f", "kh", "ts", "ch",
\_

"sh", "shch", "ie", "y", "", "e", "iu", "ia"}

For Each ch In inputValue

If Char.IsLetter(ch) AndAlso AscW(ch) \> 192 Then

SB.Append(Eng(Array.IndexOf(Rus, ch.ToString)))

Else

SB.Append(ch)

End If

Next

Return SB.ToString

End Function

 

accnt = Lastname & Firstname.Substring(0,1) & MiddleName.Substring(0,1)

 

**Правило для PersonnelNumber**

**value = "000" + \$PERSONNELNUMBER\$**
