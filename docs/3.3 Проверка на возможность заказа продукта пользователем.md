3.3 Проверка на возможность заказа продукта пользователем

5 мая 2025 г.

16:02

 

Dim runner = Session.Resolve(Of VI.DB.DataAccess.IStatementRunner)()

Dim EmpCanOrderProduct As String = ""

 

'Check that Employee has access to ITShop with the AccProduct

Using reader = runner.SqlExecute("**QER_FGIPWOOrderPerson**", {

QueryParameter.Create("@uidperson", UID_Person),

QueryParameter.Create("@uidaccproduct", strUID_AccProduct)})

> While reader.Read()
>
> EmpCanOrderProduct = reader.GetString(0)
>
> End While

End Using

 

If EmpCanOrderProduct = "False" Then

Continue For

End If
