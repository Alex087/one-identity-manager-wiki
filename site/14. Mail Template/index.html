<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>14. Mail Template - 1IM Wiki</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" disabled>
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" >
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">1IM Wiki</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item dropdown">
                              <button id="theme-menu" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme" class="nav-link dropdown-toggle">
                                <i class="fa-solid fa-circle-half-stroke fa-fw"></i>
                                <span class="d-lg-none ms-2">Toggle theme</span>
                              </button>
                              <ul class="dropdown-menu dropdown-menu-end">
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                                    <i class="fa-solid fa-sun fa-fw"></i>
                                    <span class="ms-2">Light</span>
                                    <i class="fa-solid fa-check ms-auto d-none"></i>
                                  </button>
                                </li>
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="true">
                                    <i class="fa-solid fa-moon fa-fw"></i>
                                    <span class="ms-2">Dark</span>
                                    <i class="fa-solid fa-check ms-auto"></i>
                                  </button>
                                </li>
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="auto" aria-pressed="false">
                                    <i class="fa-solid fa-circle-half-stroke fa-fw"></i>
                                    <span class="ms-2">Auto</span>
                                    <i class="fa-solid fa-check ms-auto d-none"></i>
                                  </button>
                                </li>
                              </ul>
                            </li>
                    </ul>
                </div>
            </div>
        </div>
        <script src="../js/darkmode.js"></script>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#build-links" class="nav-link">Build Links</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>14. Mail Template</p>
<p>22 июня 2021 г.</p>
<p>19:00</p>
<table style="width:94%;">
<colgroup>
<col style="width: 56%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr>
<th><strong>DialogScript</strong></th>
<th><strong> Called in mail-template with</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><p>Public Function CCC_HtmlMailText(obj As IEntity) As String</p>
<p>  Return "&lt;h1 style='color:red'&gt;" &amp; obj.Display &amp;
"&lt;/h1&gt;"</p>
<p>End Function</p></td>
<td>$SCRIPT(CCC_HtmlMailText):HTML$</td>
</tr>
</tbody>
</table>

<p><em>From
\&lt;<a href="https://www.oneidentity.com/community/identity-manager/f/forum/30123/how-to-present-a-table-with-dynamic-data-in-email-templates">https://www.oneidentity.com/community/identity-manager/f/forum/30123/how-to-present-a-table-with-dynamic-data-in-email-templates</a>&gt;</em></p>
<h1 id="build-links">Build Links</h1>
<p>Script: VI_BuildITShopLinks</p>
<hr />
<p><strong>Using scripts in mail templates</strong></p>
<p>For more information about using scripts, see the <em>One Identity Manager
Configuration Guide</em>.</p>
<p>In mail templates, any parameters can be used when calling a script.</p>
<p><strong>Syntax</strong></p>
<p>\$SCRIPT(ScriptName, "Options")\$</p>
<p>The Options parameter is optional and is passed as a string. Custom
parameters can be coded in any way in this string. Quotes ("") are
masked by doubling. In the script, the parameter is passed as the second
parameter after the base object. The base object can be
either IEntity or ISingleDbObject.</p>
<p><strong>Script example</strong></p>
<p>Public Function CCC_Script(baseEntity as IEntity, options as String) as
String</p>
<p>Dim arr = options.Split("|"c)</p>
<p>Dim p1 = arr(0)</p>
<p>Dim p2 = arr(1)</p>
<p>End Function</p>
<p><strong>Example of use in mail templates</strong></p>
<p>\$SCRIPT(CCC_Script, "Param1|Param2")\$</p>
<p><strong>Support for dynamically generated HTML code in mail templates</strong></p>
<p>For detailed information about using dollar (\$) notation, see the <em>One
Identity Manager Configuration Guide</em>.</p>
<p>In dollar notation, you can select the <strong>HTML</strong> type. The HTML code is
accepted in scripts and columns but not masked. There is no security
check.</p>
<p><strong>Example script with HTML code:</strong></p>
<p>Public Function CCC_HtmlMailText(obj As IEntity) As String</p>
<p>Return "\&lt;h1 style='color:red'&gt;" &amp; obj.Display &amp; "\&lt;/h1&gt;"</p>
<p>End Function</p>
<p><strong>Call in mail template:</strong></p>
<p>\$SCRIPT(CCC_HtmlMailText):HTML\$</p>
<p><em>From
\&lt;<a href="https://support.oneidentity.com/technical-documents/identity-manager/8.1.3/operational-guide/13#TOPIC-1481199">https://support.oneidentity.com/technical-documents/identity-manager/8.1.3/operational-guide/13#TOPIC-1481199</a>&gt;</em></p>
<hr />
<p>Для того, чтобы передать из процесса данные в шаблон нужно в параметрах
шага процесса по отправке почты указать параметр и его значение</p>
<p><img src="../media/14. Mail Template/media/image1.png"
style="width:5.90625in;height:4.33333in" /></p>
<p>В шаблоне указываем</p>
<p>\$PC(Roles)\$</p>
<p>Чтобы получить из скрипта результат:</p>
<p><img src="../media/14. Mail Template/media/image2.png"
style="width:5.53125in;height:2.16667in" /></p>
<hr />
<p>Select the category <strong>IT Shop | Basic configuration data | Mail
templates | Predefined</strong>.</p>
<p>Email notifications are generated through default processes during
process handling. To use email notifications based on mail templates for
other business procedures, for example creating user accounts, you have
to create custom mail templates and processes. <strong>The process task
"SendRichMail" is provided for this through the process component
"MailComponent".</strong></p>
<p><a href="https://support.oneidentity.com/technical-documents/identity-manager/8.0/configuration-guide/93">https://support.oneidentity.com/technical-documents/identity-manager/8.0/configuration-guide/93</a></p>
<p>Не дает менять предустановленные шаблоны.</p>
<p>Надо скопировать его в новый и там уже править.</p>
<hr />
<p>Вставка параметров в шаблон</p>
<p>Надо в процессе задействовать ParamName и ParamValue</p>
<p>В шаблоне обращаемся так</p>
<p><strong><em>\$PC(ParamName)\$</em></strong></p>
<p>Результат выполнения скрипта можно отобразить так:</p>
<p><strong><em>\$Script(VI_GetRichMailSignature_Caption)\$</em></strong></p>
<p><strong><em>---</em></strong></p>
<p>Чтобы корректно отображался Mail Definition - надо в параметрах процесса
передавать Culture (Value = "ru")</p>
<p><strong><em>----</em></strong></p>
<p>Чтобы получить результат выполнения скрипта с параметром, можно в
параметрах шага процесса указать</p>
<p>Value = CCC_Department_Get_XDateInserted(\$DepartmentName\$)</p>
<p>И затем вызвать в шаблоне этот параметр</p>
<p>\$PC(Date1)\$</p>
<p>Сам скрипт:</p>
<p>Public Function CCC_Department_Get_XDateInserted(ByVal department As
String) As String</p>
<p>' Get the SQL formatter for our connection</p>
<p>Dim f As ISqlFormatter = Session.SqlFormatter</p>
<p>' Build the WHERE clause for our request</p>
<p>Dim where As String = f.Comparison("DepartmentName", department,
ValType.String)</p>
<p>Dim Date1 As DateTime</p>
<p>Date1 = Session.Source.GetSingleValue(Of DateTime)("Department",
"XDateInserted", where)</p>
<p>Return Date1.ToString()</p>
<p>End Function</p>
<p><strong><em>------</em></strong></p>
<p><strong><em>Получение адреса руководителя департамента</em></strong></p>
<p>Поместить в pre-script generating</p>
<p>values("ContactEmail") =
\$FK(UID_Department).FK(UID_PersonHead).ContactEmail\$</p>
<p>В значении параметра писать</p>
<p>Value = values("ContactEmail")</p>
<hr />
<p>Передача параметров</p>
<p>Указать BaseObject параметрах процесса XObjectKey</p>
<p>Value = \$FK(UID_Person).XObjectKey\$</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
